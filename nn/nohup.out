[T3S_trajsimi_train.py:389 <module>()] -> python T3S_trajsimi_train.py --dataset porto --trajsimi_measure dtw --seed 2000 --debug --sample_ratio 0.5 --strategy copyactivate./output/porto_t3s_dtw_20200_7k_2k_0.5_active
[T3S_trajsimi_train.py:390 <module>()] -> =================================
[T3S_trajsimi_train.py:391 <module>()] -> debug = True
dumpfile_uniqueid = 
seed = 2000
gpu = False
root_dir = /home/haitao/data/GoodST/code/baseline/TrajSimiMeasures
data_dir = /home/haitao/data/GoodST/code/baseline/TrajSimiMeasures/data
snapshot_dir = /home/haitao/data/GoodST/code/baseline/TrajSimiMeasures/exp/snapshot
dataset = porto
dataset_prefix = porto_20inf
dataset_file = /home/haitao/data/GoodST/code/baseline/TrajSimiMeasures/data/porto_20inf
dataset_trajsimi_dict = /home/haitao/data/GoodST/code/baseline/TrajSimiMeasures/data/porto_20inf_trajsimi_20200_dict_dtw
min_lon = -8.7005
min_lat = 41.1001
max_lon = -8.5192
max_lat = 41.2086
cell_size = 100
min_traj_len = 20
max_traj_len = 2147483647
effi_exp = numtrajs
effi_method = 
effi_auxilary_processor = True
effi_num_trajs = 100000
effi_min_traj_len = 20
effi_max_traj_len = 200
effi_dataloader_num_workers = 0
effi_cpu_method_num_cores = 8
effi_batch_size_cpu_heuristic = 512
effi_batch_size_cpu_learned = 512
effi_batch_size_gpu = 512
effi_timeout = 7200
effi_gpu_threads_per_traj = 64
trajsimi_measure = dtw
trajsimi_min_traj_len = 20
trajsimi_max_traj_len = 200
trajsimi_edr_lcss_eps = 200
trajsimi_edr_lcss_delta = 60
trajsimi_timereport_exp = False
trajsimi_sar_distance_eps = 200
trajsimi_sar_time_eps = 10
trajsimi_sar_target_length = 10
knn_exp = 
knn_topk = 50
knn_dataloader_num_workers = 0
knn_query_threads_cpu = 1
knn_query_threads_gpu = 8
knn_emb_batch_size_cpu = 1
knn_emb_batch_size_gpu = 512
knn_faiss_index = IVF
clustering_exp = numtrajs
clustering_num_centroids = 10
clustering_method = 
clustering_truth_heur_method = dtw
clustering_num_trajs = 1000
clustering_min_traj_len = 20
clustering_max_traj_len = 200
clustering_auxilary_processor = True
cell_embedding_dim = 128
traj_embedding_dim = 128
trjsr_imgsize_x_lr = 162
trjsr_imgsize_y_lr = 128
trjsr_pixelrange_lr = 2
tmn_pooling_size = 10
tmn_sampling_num = 20
trajgat_num_head = 8
trajgat_num_encoder_layers = 3
trajgat_d_lap_pos = 8
trajgat_encoder_dropout = 0.01
trajgat_dataloader_num_workers = 8
trajgat_qtree_node_capacity = 50
rsts_num_layers = 3
rsts_bidirectional = True
rsts_dropout = 0.2
strategy = copyactivate./output/porto_t3s_dtw_20200_7k_2k_0.5_active
sample_ratio = 0.5
dataset_trajsimi_traj = /home/haitao/data/GoodST/code/baseline/TrajSimiMeasures/data/porto_20inf_trajsimi_20200_dict_traj
[T3S_trajsimi_train.py:392 <module>()] -> =================================
[T3S_trajsimi_train.py:334 __trajcoor_to_trajcoor_and_trajgrid()] -> trajcoor_to_trajgrid starts. #=1000
[T3S_trajsimi_train.py:349 __trajcoor_to_trajcoor_and_trajgrid()] -> trajcoor_to_trajgrid ends. @=0.140, #=1000
[T3S_trajsimi_train.py:334 __trajcoor_to_trajcoor_and_trajgrid()] -> trajcoor_to_trajgrid starts. #=2000
[T3S_trajsimi_train.py:349 __trajcoor_to_trajcoor_and_trajgrid()] -> trajcoor_to_trajgrid ends. @=0.198, #=2000
[T3S_trajsimi_train.py:334 __trajcoor_to_trajcoor_and_trajgrid()] -> trajcoor_to_trajgrid starts. #=3500
[T3S_trajsimi_train.py:349 __trajcoor_to_trajcoor_and_trajgrid()] -> trajcoor_to_trajgrid ends. @=0.401, #=3500
[T3S_trajsimi_train.py:322 load_trajsimi_dataset()] -> trajsimi dataset sizes. (trains/evals/tests=3500/1000/2000)
[T3S_trajsimi_train.py:51 train()] -> training. START! @=1742378513.298
[T3S_trajsimi_train.py:130 train()] -> training. ep-batch=0-0, train_loss=48.2651, @=0.320, gpu=(17876, 24564), ram=1275
[T3S_trajsimi_train.py:130 train()] -> training. ep-batch=0-100, train_loss=0.0947, @=0.035, gpu=(20830, 24564), ram=1283
[T3S_trajsimi_train.py:146 train()] -> training. i_ep=0, loss=2.5103, @=8.636
[T3S_trajsimi_train.py:157 train()] -> eval.     i_ep=0, loss=0.0165, hr=0.180,0.318,0.533
Traceback (most recent call last):
  File "/home/haitao/data/GoodST/code/baseline/TrajSimiMeasures/nn/T3S_trajsimi_train.py", line 397, in <module>
    t3s.train()
  File "/home/haitao/data/GoodST/code/baseline/TrajSimiMeasures/nn/T3S_trajsimi_train.py", line 166, in train
    torch.save({'model': self.model.state_dict()}, self.checkpoint_path)
  File "/home/haitao/anaconda3/envs/goodST/lib/python3.9/site-packages/torch/serialization.py", line 618, in save
    with _open_zipfile_writer(f) as opened_zipfile:
  File "/home/haitao/anaconda3/envs/goodST/lib/python3.9/site-packages/torch/serialization.py", line 492, in _open_zipfile_writer
    return container(name_or_buffer)
  File "/home/haitao/anaconda3/envs/goodST/lib/python3.9/site-packages/torch/serialization.py", line 463, in __init__
    super().__init__(torch._C.PyTorchFileWriter(self.name))
RuntimeError: Parent directory /home/haitao/data/GoodST/code/baseline/TrajSimiMeasures/exp/snapshot/porto_20inf_trajsimi_T3S_dtw_best_0.5_copyactivate./output does not exist.
Traceback (most recent call last):
  File "T3S_trajsimi_train.py", line 4, in <module>
    import torch
ModuleNotFoundError: No module named 'torch'
usage: T3S_trajsimi_train.py [-h] [--debug]
                             [--dumpfile_uniqueid DUMPFILE_UNIQUEID]
                             [--seed SEED] [--dataset DATASET]
                             [--trajsimi_measure TRAJSIMI_MEASURE]
                             [--cell_embedding_dim CELL_EMBEDDING_DIM]
                             [--traj_embedding_dim TRAJ_EMBEDDING_DIM]
                             [--trajsimi_min_traj_len TRAJSIMI_MIN_TRAJ_LEN]
                             [--trajsimi_max_traj_len TRAJSIMI_MAX_TRAJ_LEN]
                             [--sample_ratio SAMPLE_RATIO]
                             [--strategy STRATEGY]
T3S_trajsimi_train.py: error: unrecognized arguments: ../output/porto_t3s_dtw_20200_7k_2k_0.5_active
